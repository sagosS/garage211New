{% extends "base.html" %}
{% block content %}
{% include 'includes/admin_navbar.html' %}
<div class="projects-section">
    <h2>{% if edit_project %}Редагувати проєкт{% else %}Новий проєкт{% endif %}</h2>
    <form method="POST" class="project-form">
        <input type="text" name="name" placeholder="Назва проєкту" required value="{{ edit_project.name if edit_project else '' }}">
        <div class="images-list">
            {% for img in images %}
                <label class="image-checkbox">
                    <input type="checkbox" name="project_images" value="{{ img }}"
                        {% if edit_project and img in edit_project.images %}checked{% endif %}>
                    <img src="{{ url_for('static', filename='uploads/' ~ img) }}" alt="">
                </label>
            {% endfor %}
        </div>
        {% if edit_project %}
            <input type="hidden" name="idx" value="{{ projects.index(edit_project) }}">
            <button type="submit">Зберегти зміни</button>
            <a href="{{ url_for('admin.admin_projects') }}" class="cancel-btn">Скасувати</a>
        {% else %}
            <button type="submit">Створити проєкт</button>
        {% endif %}
    </form>

    <div class="projects-list">
        <h3 style="margin-bottom:1.2rem;">Існуючі проєкти:</h3>
        {% for project in projects %}
            <div class="project-block">
                <div class="project-title">{{ project.name }}</div>
                <div class="project-images">
                    {% for img in project.images %}
                        <img src="{{ url_for('static', filename='uploads/' ~ img) }}" alt="">
                    {% endfor %}
                </div>
                <div class="project-actions">
                    <a href="{{ url_for('admin.admin_projects', edit=loop.index0) }}" class="edit-btn">Редагувати</a>
                    <a href="{{ url_for('admin.admin_projects', delete=loop.index0) }}" class="delete-btn" onclick="return confirm('Видалити цей проєкт?')">Видалити</a>
                </div>
            </div>
        {% else %}
            <p style="color:#888;">Проєктів ще немає.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}